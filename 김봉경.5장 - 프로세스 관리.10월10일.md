### 1. 프로세스의 개념

- 프로세스란 실행 중인 프로그램을 뜻한다.
- 프로세스의 문맥은 그 프로세스의 주소 공간(코드, 데이터, 스택 상태)을 비롯해 레지스터에 어떤 값을 가지고 있었는지와, 시스템 콜 등을 통해 커널에서 수행한 일의 상태, 그 프로세스에 관해 커널이 관리하고 있는 각종 정보 등을 포함하게 된다.

### 2. 프로세스의 상태

- 프로세스의 상태는 실행(running), 준비(ready), 봉쇄(blocked, wait, sleep)의 세 가지로 구분할 수 있다.

  - 실행
프로세스가 CPU를 보유하고, 기계어 명령을 실행하고 있는 상태

  - 준비
프로세스가 CPU만 보유하면 당장 명령을 실행할 수 있지만 CPU를 할당받지 못한 상태

  - 봉쇄
CPU를 할당받더라도 당장 명령을 실행할 수 없는 프로세스의 상태

- 문맥교환(context switch)
실행시킬 프로세스를 변경하기 위해 원래 수행 중이던 프로세스의 문맥을 저장하고 새로운 프로세스의 문맥을 세팅하는 과정

- CPU 디스패치(dispatch)
준비 상태에 있는 프로세스들 중에서 CPU를 할당받을 프로세스를 선택한 후 실제로 CPU의 제어권을 넘겨받는 과정

### 3. 프로세스 제어블록

- 프로세스 제어블록(Process Control Block: PCB)이란 운영체제가 시스템 내의 프로세스들을 관리하기 위해 프로세스마다 유지하는 정보들을 담는 커널 내의 자료구조

- PCB의 구성요소
  - 프로세스의 상태(process state)
  CPU를 할댕해도 되는지 여부를 결정하기 위해 필요
  - 프로그램 카운터(program counter)의 값
  다음에 수행할 명령의 위치를 가리킨다
  - CPU 레지스터(CPU register)의 값
  CPU 연산을 위해 현 시점에 레지스터에 어떤 값을 저장하고 있는지를 나타낸다
  - CPU 스케줄링 정보(CPU scheduling information)
  각각 그 프로세스의 CPU 스케줄링을 위해 필요한 정보
  - 메모리 관리 정보(memory management information)
  각각 그 프로세스의 메모리 할당을 위해 필요한 정보
  - 자원 사용 정보(accounting information)
  사용자에게 자원 사용 요금을 계산해 청구하는 등의 용도로 사용
  - 입출력 상태 정보(I/O status information)
  프로세스가 오픈한 파일 정보 등 프로세스의 입출력 관련 상태 정보를 나타낸다.
  
### 4. 문맥교환

- 문맥교환(context switch)이란 하나의 사용자 프로세스로부터 다른 사용자 프로세스로 CPU의 제어권이 이양되는 과정

- 타이머 인터럽트가 발생하거나 프로세스가 입출력 요청 시스템 콜을 하여 봉쇄 상태에 들어가는 경우에는 문맥교환이 일어나지만, 그 밖의 인터럽트나 시스템 콜 발생 시에는 문맥교환이 일어나지 않고 실행 모드만이 변경될 뿐이다.

### 5. 프로세스를 스케줄링하기 위한 큐

- 운영체제는 준비 상태에 있는 프로세스들을 줄 세우기 위해 준비 큐(ready queue)를 두고 준비 큐의 제일 앞에 줄 서 있는 프로세스에 제일 먼저 CPU를 할당한다.

- 준비 큐에 프로세스를 줄 세우는 방법을 CPU 스케줄링 방법에 따라 달라진다.

- 준비 큐 외에도 운영체제는 특정 자원을 기다리는 프로세스들을 줄 세우기 위해 자원별로 장치 큐(device queue)를 둔다

- 운영체제는 준비 큐와 장치 큐 외에도 작업 큐(job queue)를 추가로 유지한다.

- 작업 큐는 시스템 내의 모든 프로세스를 관리하기 위한 큐로, 프로세스의 상태와 무관하게 현재 시스템 내에 있는 모든 프로세스가 작업 큐에 속하게 된다.

### 6. 스케줄러

- 스케줄러(scheduler)란 어떤 프로세스에게 자원을 할당할지를 결정하는 운영체제 커널의 코드를 지칭한다.

- 스케줄러에는 장기 스케줄러(long term scheduler)와 단기 스케줄러(short term scheduler)가 있다.

- 장기 스케줄러
작업 스케줄러(job scheduler)라고도 부르며, 어떤 프로세스를 준비 큐에 진입시킬지 결정하는 역할

- 단기 스케줄러
CPU 스케줄러라고도 하며, 준비 상태의 프로세스 중에서 어떤 프로세스를 다음번에 실행 상태로 만들 것인지 결정한다.
시분할 시스템에서는 타이머 인터럽트가 발생하면 단기 스케줄러가 호출된다.

- 현대의 시분할 시스템용 운영체제에서는 장기 스케줄러 대신 `중기 스케줄러(medium term scheduling)`을 두는 경우가 많다

- 중기 스케줄러
  - 메모리에 적재된 프로세스의 수를 동적으로 조절하기 위해 추가된 스케줄러
  - 중기 스케줄러의 등장으로 프로세스의 상태에 외부적인 이유로 프로세스의 수행이 정지된 상태를 나타내는 중지(suspended, stopped)상태가 추가된다.
  - 중지 상태에 있는 프로세스는 외부에서 재개시키지 않는 이상 다시 활성화될 수 없으므로 메모리 자원이 당장 필요하지 않다.
  
### 7. 프로세스의 생성

- 운영체제는 자식 프로세스의 생성을 위해 fork() 시스템 콜을 제공한다. 프로세스가 fork() 시스템 콜을 하게 되면 CPU의 제어권이 커널로 넘어가게 되고, 커널은 fork()를 호출한 프로세스를 복제해 자식 프로세스를 생성한다.
=> 즉 fork() 시스템 콜을 하게 되면 fork() 함수를 호출한 프로세스와 똑같은 프로세스가 하나 생성된다.

=> 따라서 자식 프로세스는 부모 프로세스의 처음부터 수행을 시작하는 것이 아니라 부모 프로세스가 현재 수행한 시점(프로그램 카운터 지점)부터 수행하게 된다.

- 프로세스의 생성관 관련된 fork(), exec() 등은 사용자 프로세스가 직접 수행할 수 없는 특권명령에 해당한다.
=> 따라서 시스템 콜을 통해서만 그 수행이 가능하다.

### 8. 프로세스 간의 협력

- 프로세스는 각자 자신만의 독립적인 주소 공간을 가지고 수행되며 프로세스가 다른 프로세스의 주소 공간을 참조하는 것은 허용되지 않는다.

- 프로세스 간의 협력 메커니즘을 위해 운영체제가 제공하는 대표적인 메커니즘으로는 IPC(Inter-Process Communication: 인터프로세스 커뮤니케이션)가 있다.

#### IPC
- 하나의 컴퓨터 안에서 실행 중인 서로 다른 프로세스 간에 발생하는 통신
- 프로세스들 간의 통신(communication)과 동기화를 이루기 위한 메거니즘을 의미
- 대표적인 방법으로 메시지 전달(message passing) 방식과 공유메모리(shared memory) 방식이 있고, 두 방식의 차이는 프로세스 사이에 공유 데이터(shared data) 사용유무에 있다.

- 메시지 전달
프로세스 간에 공유 데이터를 일체 사용하지 않고 메시지를 주고받으면서 통신하는 방식
메시지 통신을 하는 시스템을 커널에 의해 send(message)와 receive(message)라는 두 가지 연산을 제공받게 된다.
이 두 연산을 통해 프로세스는 전달할 메시지를 운영체제에게 시스템 콜 방식으로 요청해 전달할 수 있다.

- 공유 메모리
프로세스들이 주소 공간의 일부를 공유하는 방식
운영체제는 공유메모리를 사용하는 시스템 콜을 지원해, 서로 다른 프로세스들이 그들의 주소 공간 중 일부를 공유할 수 있도록 한다.

---

